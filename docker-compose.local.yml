services:
  # 本地开发专用：提供 Redis 容器并确保后端在 Redis 之后启动
  redis:
    image: redis:7-alpine
    # 不设置固定 container_name，避免与历史容器冲突
    # 本地联调：禁用持久化，保证每次启动都是全新、干净的状态
    restart: unless-stopped
    command: ["redis-server", "--save", "", "--appendonly", "no"]
    ports:
      - "6379:6379"
    # 使用内存型数据目录，进一步确保不落盘
    tmpfs:
      - /data

  backend1:
    depends_on:
      - redis

